[
  {
    "id": 113532995,
    "slug": "gew51xlnpitb9lhc",
    "title": "ClamAV部署及使用",
    "book_id": 36142772,
    "book": {
      "id": 36142772,
      "type": "Book",
      "slug": "blog",
      "name": "blog",
      "user_id": 5358617,
      "description": "Blog",
      "creator_id": 5358617,
      "public": 0,
      "items_count": 1,
      "likes_count": 0,
      "watches_count": 0,
      "content_updated_at": "2023-02-06T10:24:12.961Z",
      "updated_at": "2023-02-06T10:44:18.000Z",
      "created_at": "2023-02-06T09:35:37.000Z",
      "namespace": "flyflower/blog",
      "user": {
        "id": 5358617,
        "type": "User",
        "login": "flyflower",
        "name": "小钻风",
        "description": null,
        "avatar_url": "https://cdn.nlark.com/yuque/0/2020/jpeg/anonymous/1607246396026-55d348d6-a2de-4ad0-8932-22bb50e358cd.jpeg",
        "books_count": 13,
        "public_books_count": 0,
        "followers_count": 0,
        "following_count": 0,
        "created_at": "2020-12-06T09:20:17.000Z",
        "updated_at": "2023-02-06T10:41:34.000Z",
        "_serializer": "v2.user"
      },
      "_serializer": "v2.book"
    },
    "user_id": 5358617,
    "creator": {
      "id": 5358617,
      "type": "User",
      "login": "flyflower",
      "name": "小钻风",
      "description": null,
      "avatar_url": "https://cdn.nlark.com/yuque/0/2020/jpeg/anonymous/1607246396026-55d348d6-a2de-4ad0-8932-22bb50e358cd.jpeg",
      "books_count": 13,
      "public_books_count": 0,
      "followers_count": 0,
      "following_count": 0,
      "created_at": "2020-12-06T09:20:17.000Z",
      "updated_at": "2023-02-06T10:41:34.000Z",
      "_serializer": "v2.user"
    },
    "format": "lake",
    "body": "<a name=\"q9lHi\"></a>\n# 安装\nRPM包下载地址<br />[https://www.clamav.net/downloads](https://www.clamav.net/downloads)\n<a name=\"UI0Eu\"></a>\n## yum安装\n```bash\nsudo yum update -y\nsudo yum install repl-release\nsudo yum install -y openssl openssl-devel libcurl-devel zlib-devel libpng-devel libxml2-devel json-c-devel bzip2-devel pcre2-devel ncurses-devel\nsudo yum install clamav clamd clamav-update\n```\n<a name=\"sPZjA\"></a>\n# 卸载\n```python\nsudo yum remove clamav clamd clamav-update\n```\n<a name=\"X7d1I\"></a>\n# 使用\n<a name=\"dYiQA\"></a>\n## 官方文档\n[https://docs.clamav.net/](https://docs.clamav.net/)\n<a name=\"eHjuS\"></a>\n## ClamAV主要组成部分\n\n- clamd - 后台进程\n- clamav - 用户端扫描程序\n- clamav-data - 扫描器威胁特征库\n- clamav-devel - 扫描器程序依赖\n- clamav-lib - 扫描器动态调用库\n- clamav-milter - Milter module for the Clam Antivirus scanner\n- clamav-update - 更新扫描器威胁特征库\n<a name=\"pIMXY\"></a>\n## 特征库更新\n配置文件位于/etc/freshclam.conf，可修改更新频率，默认是两小时检查一次更新，找到其中的如下一段，把数值改为1：\n```bash\n# Number of database checks per day. \n# Default: 12 (every two hours) \nChecks 1\n```\n去掉配置文件中UpdateLogFile选项的注释，并设置日志保存的路径<br />执行`freshclam`命令更新威胁特征库<br />启动后台更新服务\n```bash\nsystemctl start clamav-freshclam\nsystemctl enable clamav-freshclam\n```\n<a name=\"Nsd2V\"></a>\n## 修改配置文件\n配置文件路劲：/etc/clamd.d/scan.conf\n\n- 去掉Logfile选项的注释，日志文件保存在/var/log/clamd.scan\n- LogFileMaxSize选项建议设置为10M\n- 修改LogSyslog选项为no\n- OnAccessIncludePath参数设置需要实时监测的目录\n- LocalSocket去掉注释，并修改为/tmp/clamd.socket\n- LocalSocketGroup去掉注释并修改为clamscan\n- LocalSocketMode去掉注释并修改为660\n- 如果需要阻断恶意文件的读写，需要去掉OnAccessPrevention选项的注释，并修改为yes；如果只是进行检测不阻断，只记录日志，则无需修改。\n\n都修改完毕后，保存退出。<br />执行如下命令创建日志文件：\n```\ntouch /var/log/clamd.scan\nchown clamscan:clamscan /var/log/clamd.scan\n```\n<a name=\"N3zM0\"></a>\n## 定时扫描和实时监控\n<a name=\"UILJ6\"></a>\n### 应用目录定时扫描\n每天凌晨2点进行sftp目录扫描\n```bash\n0 2 * * * /usr/bin/clamscan -r -i --quiet -o -l /var/log/clamscan.log --move=/tmp/infected /sftp\n```\n<a name=\"smzDk\"></a>\n### 应用目录实时监控\n暂时禁用 会造成被监听目录的IO性能受损、缓存性能受损 IO读写速度差距约1倍 缓存性能的影响约30倍)\n<a name=\"NotcF\"></a>\n## 上报扫描结果\n<a name=\"JBfLM\"></a>\n### 配置Logstash\n\n简介<br />工具发展里程<br />主要用途\n\n安装<br />几种安装方式<br />源码安装注意内核以及curl版本，还需要安装Python3模块cmake<br />各模块说明\n\n配置<br />配置文件位置<br />主要使用配置<br />更新特征库<br />启动后台服务\n\n\n使用<br />定期目录扫描<br />实时文件监控扫描<br />rest-api调用\n\n注意事项\n\n谷歌实际案例\n\n\n",
    "body_draft": "<a name=\"q9lHi\"></a>\n# 安装\nRPM包下载地址<br />[https://www.clamav.net/downloads](https://www.clamav.net/downloads)\n<a name=\"UI0Eu\"></a>\n## yum安装\n```bash\nsudo yum update -y\nsudo yum install repl-release\nsudo yum install -y openssl openssl-devel libcurl-devel zlib-devel libpng-devel libxml2-devel json-c-devel bzip2-devel pcre2-devel ncurses-devel\nsudo yum install clamav clamd clamav-update\n```\n<a name=\"sPZjA\"></a>\n# 卸载\n```python\nsudo yum remove clamav clamd clamav-update\n```\n<a name=\"X7d1I\"></a>\n# 使用\n<a name=\"dYiQA\"></a>\n## 官方文档\n[https://docs.clamav.net/](https://docs.clamav.net/)\n<a name=\"eHjuS\"></a>\n## ClamAV主要组成部分\n\n- clamd - 后台进程\n- clamav - 用户端扫描程序\n- clamav-data - 扫描器威胁特征库\n- clamav-devel - 扫描器程序依赖\n- clamav-lib - 扫描器动态调用库\n- clamav-milter - Milter module for the Clam Antivirus scanner\n- clamav-update - 更新扫描器威胁特征库\n<a name=\"pIMXY\"></a>\n## 特征库更新\n配置文件位于/etc/freshclam.conf，可修改更新频率，默认是两小时检查一次更新，找到其中的如下一段，把数值改为1：\n```bash\n# Number of database checks per day. \n# Default: 12 (every two hours) \nChecks 1\n```\n去掉配置文件中UpdateLogFile选项的注释，并设置日志保存的路径<br />执行`freshclam`命令更新威胁特征库<br />启动后台更新服务\n```bash\nsystemctl start clamav-freshclam\nsystemctl enable clamav-freshclam\n```\n<a name=\"Nsd2V\"></a>\n## 修改配置文件\n配置文件路劲：/etc/clamd.d/scan.conf\n\n- 去掉Logfile选项的注释，日志文件保存在/var/log/clamd.scan\n- LogFileMaxSize选项建议设置为10M\n- 修改LogSyslog选项为no\n- OnAccessIncludePath参数设置需要实时监测的目录\n- LocalSocket去掉注释，并修改为/tmp/clamd.socket\n- LocalSocketGroup去掉注释并修改为clamscan\n- LocalSocketMode去掉注释并修改为660\n- 如果需要阻断恶意文件的读写，需要去掉OnAccessPrevention选项的注释，并修改为yes；如果只是进行检测不阻断，只记录日志，则无需修改。\n\n都修改完毕后，保存退出。<br />执行如下命令创建日志文件：\n```\ntouch /var/log/clamd.scan\nchown clamscan:clamscan /var/log/clamd.scan\n```\n<a name=\"N3zM0\"></a>\n## 定时扫描和实时监控\n<a name=\"UILJ6\"></a>\n### 应用目录定时扫描\n每天凌晨2点进行sftp目录扫描\n```bash\n0 2 * * * /usr/bin/clamscan -r -i --quiet -o -l /var/log/clamscan.log --move=/tmp/infected /sftp\n```\n<a name=\"smzDk\"></a>\n### 应用目录实时监控\n暂时禁用 会造成被监听目录的IO性能受损、缓存性能受损 IO读写速度差距约1倍 缓存性能的影响约30倍)\n<a name=\"NotcF\"></a>\n## 上报扫描结果\n<a name=\"JBfLM\"></a>\n### 配置Logstash\n\n简介<br />工具发展里程<br />主要用途\n\n安装<br />几种安装方式<br />源码安装注意内核以及curl版本，还需要安装Python3模块cmake<br />各模块说明\n\n配置<br />配置文件位置<br />主要使用配置<br />更新特征库<br />启动后台服务\n\n\n使用<br />定期目录扫描<br />实时文件监控扫描<br />rest-api调用\n\n注意事项\n\n谷歌实际案例\n\n\n",
    "body_html": "<!doctype html><div class=\"lake-content\" typography=\"classic\"><h1 id=\"q9lHi\"><span class=\"ne-text\">安装</span></h1><p id=\"u5a4a1607\" class=\"ne-p\"><span class=\"ne-text\">RPM包下载地址</span></p><p id=\"u24b17586\" class=\"ne-p\"><a href=\"https://www.clamav.net/downloads\" data-href=\"https://www.clamav.net/downloads\" target=\"_blank\" class=\"ne-link\"><span class=\"ne-text\">https://www.clamav.net/downloads</span></a></p><h2 id=\"UI0Eu\"><span class=\"ne-text\">yum安装</span></h2><pre data-language=\"bash\" id=\"u0Zps\" class=\"ne-codeblock language-bash\">sudo yum update -y\nsudo yum install repl-release\nsudo yum install -y openssl openssl-devel libcurl-devel zlib-devel libpng-devel libxml2-devel json-c-devel bzip2-devel pcre2-devel ncurses-devel\nsudo yum install clamav clamd clamav-update</pre><h1 id=\"sPZjA\"><span class=\"ne-text\">卸载</span></h1><pre data-language=\"python\" id=\"xC82x\" class=\"ne-codeblock language-python\">sudo yum remove clamav clamd clamav-update</pre><h1 id=\"X7d1I\"><span class=\"ne-text\">使用</span></h1><h2 id=\"dYiQA\"><span class=\"ne-text\">官方文档</span></h2><p id=\"u717f0f2e\" class=\"ne-p\"><a href=\"https://docs.clamav.net/\" data-href=\"https://docs.clamav.net/\" target=\"_blank\" class=\"ne-link\"><span class=\"ne-text\">https://docs.clamav.net/</span></a></p><h2 id=\"eHjuS\"><span class=\"ne-text\" style=\"color: rgb(51, 51, 51)\">ClamAV主要组成部分</span></h2><ul class=\"ne-ul\"><li id=\"u16ff5766\"><span class=\"ne-text\">clamd - 后台进程</span></li><li id=\"uab58a297\"><span class=\"ne-text\">clamav - 用户端扫描程序</span></li><li id=\"u23010719\"><span class=\"ne-text\">clamav-data - 扫描器威胁特征库</span></li><li id=\"ud9e7bd1c\"><span class=\"ne-text\">clamav-devel - 扫描器程序依赖</span></li><li id=\"u62d7a628\"><span class=\"ne-text\">clamav-lib - 扫描器动态调用库</span></li><li id=\"ubbae9b96\"><span class=\"ne-text\">clamav-milter - Milter module for the Clam Antivirus scanner</span></li><li id=\"ubcf3fcb4\"><span class=\"ne-text\">clamav-update - 更新扫描器威胁特征库</span></li></ul><h2 id=\"pIMXY\"><span class=\"ne-text\">特征库更新</span></h2><p id=\"u488d495a\" class=\"ne-p\"><span class=\"ne-text\">配置文件位于/etc/freshclam.conf，可修改更新频率，默认是两小时检查一次更新，</span><span class=\"ne-text\" style=\"color: rgb(51, 51, 51); font-size: 14px\">找到其中的如下一段，把数值改为1：</span></p><pre data-language=\"bash\" id=\"YkrZV\" class=\"ne-codeblock language-bash\"># Number of database checks per day. \n# Default: 12 (every two hours) \nChecks 1</pre><p id=\"u268f051e\" class=\"ne-p\"><span class=\"ne-text\">去掉配置文件中UpdateLogFile选项的注释，并设置日志保存的路径</span></p><p id=\"u99698069\" class=\"ne-p\"><span class=\"ne-text\">执行</span><code class=\"ne-code\"><span class=\"ne-text\">freshclam</span></code><span class=\"ne-text\">命令更新威胁特征库</span></p><p id=\"uedad1ba6\" class=\"ne-p\"><span class=\"ne-text\">启动后台更新服务</span></p><pre data-language=\"bash\" id=\"dMcRB\" class=\"ne-codeblock language-bash\">systemctl start clamav-freshclam\nsystemctl enable clamav-freshclam</pre><h2 id=\"Nsd2V\"><span class=\"ne-text\">修改配置文件</span></h2><p id=\"u20bf6fe3\" class=\"ne-p\"><span class=\"ne-text\">配置文件路劲：/etc/clamd.d/scan.conf</span></p><ul class=\"ne-ul\"><li id=\"u8de17e9f\"><span class=\"ne-text\">去掉Logfile选项的注释，日志文件保存在/var/log/clamd.scan</span></li><li id=\"ud95bdf76\"><span class=\"ne-text\">LogFileMaxSize选项建议设置为10M</span></li><li id=\"u917e9974\"><span class=\"ne-text\">修改LogSyslog选项为no</span></li><li id=\"ub29c6d7a\"><span class=\"ne-text\">OnAccessIncludePath参数设置需要实时监测的目录</span></li><li id=\"u6194b25a\"><span class=\"ne-text\">LocalSocket去掉注释，并修改为/tmp/clamd.socket</span></li><li id=\"uba5203ed\"><span class=\"ne-text\">LocalSocketGroup去掉注释并修改为clamscan</span></li><li id=\"u40f00c84\"><span class=\"ne-text\">LocalSocketMode去掉注释并修改为660</span></li><li id=\"udd213977\"><span class=\"ne-text\">如果需要阻断恶意文件的读写，需要去掉OnAccessPrevention选项的注释，并修改为yes；如果只是进行检测不阻断，只记录日志，则无需修改。</span></li></ul><p id=\"ubdb0aa00\" class=\"ne-p\"><span class=\"ne-text\">都修改完毕后，保存退出。</span></p><p id=\"u450fd960\" class=\"ne-p\"><span class=\"ne-text\">执行如下命令创建日志文件：</span></p><pre data-language=\"plain\" id=\"OeXwl\" class=\"ne-codeblock language-plain\">touch /var/log/clamd.scan\nchown clamscan:clamscan /var/log/clamd.scan</pre><h2 id=\"N3zM0\"><span class=\"ne-text\">定时扫描和实时监控</span></h2><h3 id=\"UILJ6\"><span class=\"ne-text\">应用目录定时扫描</span></h3><p id=\"uf99a39f4\" class=\"ne-p\"><span class=\"ne-text\">每天凌晨2点进行sftp目录扫描</span></p><pre data-language=\"bash\" id=\"X2kbT\" class=\"ne-codeblock language-bash\">0 2 * * * /usr/bin/clamscan -r -i --quiet -o -l /var/log/clamscan.log --move=/tmp/infected /sftp</pre><h3 id=\"smzDk\"><span class=\"ne-text\">应用目录实时监控</span></h3><p id=\"u64bae9c3\" class=\"ne-p\"><span class=\"ne-text\">暂时禁用 会造成被监听目录的IO性能受损、缓存性能受损 IO读写速度差距约1倍 缓存性能的影响约30倍)</span></p><h2 id=\"NotcF\"><span class=\"ne-text\">上报扫描结果</span></h2><h3 id=\"JBfLM\"><span class=\"ne-text\">配置Logstash</span></h3><p id=\"u71dd3961\" class=\"ne-p\"><br></p><p id=\"uc535cb46\" class=\"ne-p\"><span class=\"ne-text\">简介</span></p><p id=\"u5ef2ff51\" class=\"ne-p\"><span class=\"ne-text\">工具发展里程</span></p><p id=\"ua9a03040\" class=\"ne-p\"><span class=\"ne-text\">主要用途</span></p><p id=\"uf0350ada\" class=\"ne-p\"><span class=\"ne-text\"></span></p><p id=\"ueb24ac15\" class=\"ne-p\"><span class=\"ne-text\">安装</span></p><p id=\"u6d46dd93\" class=\"ne-p\"><span class=\"ne-text\">几种安装方式</span></p><p id=\"u6960874e\" class=\"ne-p\"><span class=\"ne-text\">源码安装注意内核以及curl版本，还需要安装Python3模块cmake</span></p><p id=\"u0b777730\" class=\"ne-p\"><span class=\"ne-text\">各模块说明</span></p><p id=\"u0988bd01\" class=\"ne-p\"><span class=\"ne-text\"></span></p><p id=\"ue9414d86\" class=\"ne-p\"><span class=\"ne-text\">配置</span></p><p id=\"ube92a3be\" class=\"ne-p\"><span class=\"ne-text\">配置文件位置</span></p><p id=\"uc964d4c2\" class=\"ne-p\"><span class=\"ne-text\">主要使用配置</span></p><p id=\"u10b8cfd3\" class=\"ne-p\"><span class=\"ne-text\">更新特征库</span></p><p id=\"u335d288d\" class=\"ne-p\"><span class=\"ne-text\">启动后台服务</span></p><p id=\"u86d519e0\" class=\"ne-p\"><span class=\"ne-text\"></span></p><p id=\"uca94b321\" class=\"ne-p\"><span class=\"ne-text\"></span></p><p id=\"u978bda57\" class=\"ne-p\"><span class=\"ne-text\">使用</span></p><p id=\"u5c86bc19\" class=\"ne-p\"><span class=\"ne-text\">定期目录扫描</span></p><p id=\"udf0d330d\" class=\"ne-p\"><span class=\"ne-text\">实时文件监控扫描</span></p><p id=\"u5f4773fe\" class=\"ne-p\"><span class=\"ne-text\">rest-api调用</span></p><p id=\"u694f88f9\" class=\"ne-p\"><span class=\"ne-text\"></span></p><p id=\"u151b66cf\" class=\"ne-p\"><span class=\"ne-text\">注意事项</span></p><p id=\"u56eb85ff\" class=\"ne-p\"><span class=\"ne-text\"></span></p><p id=\"u9f468887\" class=\"ne-p\"><span class=\"ne-text\">谷歌实际案例</span></p><p id=\"uf4599147\" class=\"ne-p\"><span class=\"ne-text\"></span></p><p id=\"u84d7f111\" class=\"ne-p\"><br></p></div>",
    "body_lake": "<!doctype lake><meta name=\"doc-version\" content=\"1\" /><meta name=\"typography\" content=\"classic\" /><meta name=\"viewport\" content=\"fixed\" /><meta name=\"paragraphSpacing\" content=\"relax\" /><h1 data-lake-id=\"q9lHi\" id=\"q9lHi\"><span data-lake-id=\"u1ec8c8e9\" id=\"u1ec8c8e9\">安装</span></h1><p data-lake-id=\"u5a4a1607\" id=\"u5a4a1607\"><span data-lake-id=\"ue34cd7eb\" id=\"ue34cd7eb\">RPM包下载地址</span></p><p data-lake-id=\"u24b17586\" id=\"u24b17586\"><a href=\"https://www.clamav.net/downloads\" target=\"_blank\" data-lake-id=\"u900c6945\" id=\"u900c6945\"><span data-lake-id=\"u359e24c0\" id=\"u359e24c0\">https://www.clamav.net/downloads</span></a></p><h2 data-lake-id=\"UI0Eu\" id=\"UI0Eu\"><span data-lake-id=\"ubbf08237\" id=\"ubbf08237\">yum安装</span></h2><card type=\"inline\" name=\"codeblock\" value=\"data:%7B%22mode%22%3A%22bash%22%2C%22code%22%3A%22sudo%20yum%20update%20-y%5Cnsudo%20yum%20install%20repl-release%5Cnsudo%20yum%20install%20-y%20openssl%20openssl-devel%20libcurl-devel%20zlib-devel%20libpng-devel%20libxml2-devel%20json-c-devel%20bzip2-devel%20pcre2-devel%20ncurses-devel%5Cnsudo%20yum%20install%20clamav%20clamd%20clamav-update%22%2C%22autoWrap%22%3Afalse%2C%22lineNumbers%22%3Atrue%2C%22heightLimit%22%3Atrue%2C%22collapsed%22%3Afalse%2C%22hideToolbar%22%3Afalse%2C%22name%22%3A%22%22%2C%22tabSize%22%3Anull%2C%22indentWithTab%22%3Afalse%2C%22lightLines%22%3A%5B%5D%2C%22foldLines%22%3A%5B%5D%2C%22theme%22%3A%22Github%20Light%22%2C%22__spacing%22%3A%22both%22%2C%22id%22%3A%22u0Zps%22%2C%22margin%22%3A%7B%22top%22%3Atrue%2C%22bottom%22%3Atrue%7D%7D\"></card><h1 data-lake-id=\"sPZjA\" id=\"sPZjA\"><span data-lake-id=\"u1e7d361c\" id=\"u1e7d361c\">卸载</span></h1><card type=\"inline\" name=\"codeblock\" value=\"data:%7B%22mode%22%3A%22python%22%2C%22code%22%3A%22sudo%20yum%20remove%20clamav%20clamd%20clamav-update%22%2C%22autoWrap%22%3Afalse%2C%22lineNumbers%22%3Atrue%2C%22heightLimit%22%3Atrue%2C%22collapsed%22%3Afalse%2C%22hideToolbar%22%3Afalse%2C%22name%22%3A%22%22%2C%22tabSize%22%3Anull%2C%22indentWithTab%22%3Afalse%2C%22lightLines%22%3A%5B%5D%2C%22foldLines%22%3A%5B%5D%2C%22theme%22%3A%22Github%20Light%22%2C%22__spacing%22%3A%22both%22%2C%22id%22%3A%22xC82x%22%2C%22margin%22%3A%7B%22top%22%3Atrue%2C%22bottom%22%3Atrue%7D%7D\"></card><h1 data-lake-id=\"X7d1I\" id=\"X7d1I\"><span data-lake-id=\"u19597717\" id=\"u19597717\">使用</span></h1><h2 data-lake-id=\"dYiQA\" id=\"dYiQA\"><span data-lake-id=\"uadf84ecb\" id=\"uadf84ecb\">官方文档</span></h2><p data-lake-id=\"u717f0f2e\" id=\"u717f0f2e\"><a href=\"https://docs.clamav.net/\" target=\"_blank\" data-lake-id=\"ufecb35bc\" id=\"ufecb35bc\"><span data-lake-id=\"u588523f5\" id=\"u588523f5\">https://docs.clamav.net/</span></a></p><h2 data-lake-id=\"eHjuS\" id=\"eHjuS\"><span data-lake-id=\"uca84cda3\" id=\"uca84cda3\" style=\"color: rgb(51, 51, 51)\">ClamAV主要组成部分</span></h2><ul list=\"u230b98ec\"><li fid=\"u1b72e38c\" data-lake-id=\"u16ff5766\" id=\"u16ff5766\"><span data-lake-id=\"u98530ff1\" id=\"u98530ff1\">clamd - 后台进程</span></li><li fid=\"u1b72e38c\" data-lake-id=\"uab58a297\" id=\"uab58a297\"><span data-lake-id=\"ua57a44d8\" id=\"ua57a44d8\">clamav - 用户端扫描程序</span></li><li fid=\"u1b72e38c\" data-lake-id=\"u23010719\" id=\"u23010719\"><span data-lake-id=\"u1fe9c4b7\" id=\"u1fe9c4b7\">clamav-data - 扫描器威胁特征库</span></li><li fid=\"u1b72e38c\" data-lake-id=\"ud9e7bd1c\" id=\"ud9e7bd1c\"><span data-lake-id=\"u83d8e9e4\" id=\"u83d8e9e4\">clamav-devel - 扫描器程序依赖</span></li><li fid=\"u1b72e38c\" data-lake-id=\"u62d7a628\" id=\"u62d7a628\"><span data-lake-id=\"ua7b13137\" id=\"ua7b13137\">clamav-lib - 扫描器动态调用库</span></li><li fid=\"u1b72e38c\" data-lake-id=\"ubbae9b96\" id=\"ubbae9b96\"><span data-lake-id=\"uf29794ad\" id=\"uf29794ad\">clamav-milter - Milter module for the Clam Antivirus scanner</span></li><li fid=\"u1b72e38c\" data-lake-id=\"ubcf3fcb4\" id=\"ubcf3fcb4\"><span data-lake-id=\"ud7ee32db\" id=\"ud7ee32db\">clamav-update - 更新扫描器威胁特征库</span></li></ul><h2 data-lake-id=\"pIMXY\" id=\"pIMXY\"><span data-lake-id=\"u6a9b2838\" id=\"u6a9b2838\">特征库更新</span></h2><p data-lake-id=\"u488d495a\" id=\"u488d495a\"><span data-lake-id=\"u6a4ed230\" id=\"u6a4ed230\">配置文件位于/etc/freshclam.conf，可修改更新频率，默认是两小时检查一次更新，</span><span data-lake-id=\"u5542249c\" id=\"u5542249c\" class=\"lake-fontsize-11\" style=\"color: rgb(51, 51, 51)\">找到其中的如下一段，把数值改为1：</span></p><card type=\"inline\" name=\"codeblock\" value=\"data:%7B%22mode%22%3A%22bash%22%2C%22code%22%3A%22%23%20Number%20of%20database%20checks%20per%20day.%20%5Cn%23%20Default%3A%2012%20(every%20two%20hours)%20%5CnChecks%201%22%2C%22autoWrap%22%3Afalse%2C%22lineNumbers%22%3Atrue%2C%22heightLimit%22%3Atrue%2C%22collapsed%22%3Afalse%2C%22hideToolbar%22%3Afalse%2C%22name%22%3A%22%22%2C%22tabSize%22%3Anull%2C%22indentWithTab%22%3Afalse%2C%22lightLines%22%3A%5B%5D%2C%22foldLines%22%3A%5B%5D%2C%22theme%22%3A%22Github%20Light%22%2C%22__spacing%22%3A%22both%22%2C%22id%22%3A%22YkrZV%22%2C%22margin%22%3A%7B%22top%22%3Atrue%2C%22bottom%22%3Atrue%7D%7D\"></card><p data-lake-id=\"u268f051e\" id=\"u268f051e\"><span data-lake-id=\"u1f17b875\" id=\"u1f17b875\">去掉配置文件中UpdateLogFile选项的注释，并设置日志保存的路径</span></p><p data-lake-id=\"u99698069\" id=\"u99698069\"><span data-lake-id=\"ubce37db0\" id=\"ubce37db0\">执行</span><code data-lake-id=\"u22dc4d94\" id=\"u22dc4d94\"><span data-lake-id=\"ue7591dd0\" id=\"ue7591dd0\">freshclam</span></code><span data-lake-id=\"u98798f2a\" id=\"u98798f2a\">命令更新威胁特征库</span></p><p data-lake-id=\"uedad1ba6\" id=\"uedad1ba6\"><span data-lake-id=\"u92cc14c5\" id=\"u92cc14c5\">启动后台更新服务</span></p><card type=\"inline\" name=\"codeblock\" value=\"data:%7B%22mode%22%3A%22bash%22%2C%22code%22%3A%22systemctl%20start%20clamav-freshclam%5Cnsystemctl%20enable%20clamav-freshclam%22%2C%22autoWrap%22%3Afalse%2C%22lineNumbers%22%3Atrue%2C%22heightLimit%22%3Atrue%2C%22collapsed%22%3Afalse%2C%22hideToolbar%22%3Afalse%2C%22name%22%3A%22%22%2C%22tabSize%22%3Anull%2C%22indentWithTab%22%3Afalse%2C%22lightLines%22%3A%5B%5D%2C%22foldLines%22%3A%5B%5D%2C%22theme%22%3A%22Github%20Light%22%2C%22__spacing%22%3A%22both%22%2C%22id%22%3A%22dMcRB%22%2C%22margin%22%3A%7B%22top%22%3Atrue%2C%22bottom%22%3Atrue%7D%7D\"></card><h2 data-lake-id=\"Nsd2V\" id=\"Nsd2V\"><span data-lake-id=\"u0e6bf4e4\" id=\"u0e6bf4e4\">修改配置文件</span></h2><p data-lake-id=\"u20bf6fe3\" id=\"u20bf6fe3\"><span data-lake-id=\"u9602e131\" id=\"u9602e131\">配置文件路劲：/etc/clamd.d/scan.conf</span></p><ul list=\"u1b74175b\"><li fid=\"u9be6a744\" data-lake-id=\"u8de17e9f\" id=\"u8de17e9f\"><span data-lake-id=\"u8af50b97\" id=\"u8af50b97\">去掉Logfile选项的注释，日志文件保存在/var/log/clamd.scan</span></li><li fid=\"u9be6a744\" data-lake-id=\"ud95bdf76\" id=\"ud95bdf76\"><span data-lake-id=\"u41803b56\" id=\"u41803b56\">LogFileMaxSize选项建议设置为10M</span></li><li fid=\"u9be6a744\" data-lake-id=\"u917e9974\" id=\"u917e9974\"><span data-lake-id=\"u46d16a05\" id=\"u46d16a05\">修改LogSyslog选项为no</span></li><li fid=\"u9be6a744\" data-lake-id=\"ub29c6d7a\" id=\"ub29c6d7a\"><span data-lake-id=\"uc735404b\" id=\"uc735404b\">OnAccessIncludePath参数设置需要实时监测的目录</span></li><li fid=\"u9be6a744\" data-lake-id=\"u6194b25a\" id=\"u6194b25a\"><span data-lake-id=\"u252c492d\" id=\"u252c492d\">LocalSocket去掉注释，并修改为/tmp/clamd.socket</span></li><li fid=\"u9be6a744\" data-lake-id=\"uba5203ed\" id=\"uba5203ed\"><span data-lake-id=\"u990624fa\" id=\"u990624fa\">LocalSocketGroup去掉注释并修改为clamscan</span></li><li fid=\"u9be6a744\" data-lake-id=\"u40f00c84\" id=\"u40f00c84\"><span data-lake-id=\"u2ae94a54\" id=\"u2ae94a54\">LocalSocketMode去掉注释并修改为660</span></li><li fid=\"u9be6a744\" data-lake-id=\"udd213977\" id=\"udd213977\"><span data-lake-id=\"ubec29e56\" id=\"ubec29e56\">如果需要阻断恶意文件的读写，需要去掉OnAccessPrevention选项的注释，并修改为yes；如果只是进行检测不阻断，只记录日志，则无需修改。</span></li></ul><p data-lake-id=\"ubdb0aa00\" id=\"ubdb0aa00\"><span data-lake-id=\"u23c089e8\" id=\"u23c089e8\">都修改完毕后，保存退出。</span></p><p data-lake-id=\"u450fd960\" id=\"u450fd960\"><span data-lake-id=\"uc18ef047\" id=\"uc18ef047\">执行如下命令创建日志文件：</span></p><card type=\"inline\" name=\"codeblock\" value=\"data:%7B%22mode%22%3A%22plain%22%2C%22code%22%3A%22touch%20%2Fvar%2Flog%2Fclamd.scan%5Cnchown%20clamscan%3Aclamscan%20%2Fvar%2Flog%2Fclamd.scan%22%2C%22autoWrap%22%3Afalse%2C%22lineNumbers%22%3Atrue%2C%22heightLimit%22%3Atrue%2C%22collapsed%22%3Afalse%2C%22hideToolbar%22%3Afalse%2C%22name%22%3A%22%22%2C%22tabSize%22%3Anull%2C%22indentWithTab%22%3Afalse%2C%22lightLines%22%3A%5B%5D%2C%22foldLines%22%3A%5B%5D%2C%22theme%22%3A%22Github%20Light%22%2C%22__spacing%22%3A%22both%22%2C%22id%22%3A%22OeXwl%22%2C%22margin%22%3A%7B%22top%22%3Atrue%2C%22bottom%22%3Atrue%7D%7D\"></card><h2 data-lake-id=\"N3zM0\" id=\"N3zM0\"><span data-lake-id=\"ubf606611\" id=\"ubf606611\">定时扫描和实时监控</span></h2><h3 data-lake-id=\"UILJ6\" id=\"UILJ6\"><span data-lake-id=\"u57715ac5\" id=\"u57715ac5\">应用目录定时扫描</span></h3><p data-lake-id=\"uf99a39f4\" id=\"uf99a39f4\"><span data-lake-id=\"u8fa5264c\" id=\"u8fa5264c\">每天凌晨2点进行sftp目录扫描</span></p><card type=\"inline\" name=\"codeblock\" value=\"data:%7B%22mode%22%3A%22bash%22%2C%22code%22%3A%220%202%20*%20*%20*%20%2Fusr%2Fbin%2Fclamscan%20-r%20-i%20--quiet%20-o%20-l%20%2Fvar%2Flog%2Fclamscan.log%20--move%3D%2Ftmp%2Finfected%20%2Fsftp%22%2C%22autoWrap%22%3Afalse%2C%22lineNumbers%22%3Atrue%2C%22heightLimit%22%3Atrue%2C%22collapsed%22%3Afalse%2C%22hideToolbar%22%3Afalse%2C%22name%22%3A%22%22%2C%22tabSize%22%3Anull%2C%22indentWithTab%22%3Afalse%2C%22lightLines%22%3A%5B%5D%2C%22foldLines%22%3A%5B%5D%2C%22theme%22%3A%22Github%20Light%22%2C%22__spacing%22%3A%22both%22%2C%22id%22%3A%22X2kbT%22%2C%22margin%22%3A%7B%22top%22%3Atrue%2C%22bottom%22%3Atrue%7D%7D\"></card><h3 data-lake-id=\"smzDk\" id=\"smzDk\"><span data-lake-id=\"ua2d6244d\" id=\"ua2d6244d\">应用目录实时监控</span></h3><p data-lake-id=\"u64bae9c3\" id=\"u64bae9c3\"><span data-lake-id=\"u23aeda2a\" id=\"u23aeda2a\">暂时禁用 会造成被监听目录的IO性能受损、缓存性能受损 IO读写速度差距约1倍 缓存性能的影响约30倍)</span></p><h2 data-lake-id=\"NotcF\" id=\"NotcF\"><span data-lake-id=\"ud3cd1787\" id=\"ud3cd1787\">上报扫描结果</span></h2><h3 data-lake-id=\"JBfLM\" id=\"JBfLM\"><span data-lake-id=\"u8814a83d\" id=\"u8814a83d\">配置Logstash</span></h3><p data-lake-id=\"u71dd3961\" id=\"u71dd3961\"><br></p><p data-lake-id=\"uc535cb46\" id=\"uc535cb46\"><span data-lake-id=\"udaecda59\" id=\"udaecda59\">简介</span></p><p data-lake-id=\"u5ef2ff51\" id=\"u5ef2ff51\"><span data-lake-id=\"u2f166bae\" id=\"u2f166bae\">工具发展里程</span></p><p data-lake-id=\"ua9a03040\" id=\"ua9a03040\"><span data-lake-id=\"u186dd38e\" id=\"u186dd38e\">主要用途</span></p><p data-lake-id=\"uf0350ada\" id=\"uf0350ada\"><span data-lake-id=\"u64eb1f4c\" id=\"u64eb1f4c\">​</span><br></p><p data-lake-id=\"ueb24ac15\" id=\"ueb24ac15\"><span data-lake-id=\"u786cd985\" id=\"u786cd985\">安装</span></p><p data-lake-id=\"u6d46dd93\" id=\"u6d46dd93\"><span data-lake-id=\"u61996447\" id=\"u61996447\">几种安装方式</span></p><p data-lake-id=\"u6960874e\" id=\"u6960874e\"><span data-lake-id=\"u23762a75\" id=\"u23762a75\">源码安装注意内核以及curl版本，还需要安装Python3模块cmake</span></p><p data-lake-id=\"u0b777730\" id=\"u0b777730\"><span data-lake-id=\"uc9a8dfe1\" id=\"uc9a8dfe1\">各模块说明</span></p><p data-lake-id=\"u0988bd01\" id=\"u0988bd01\"><span data-lake-id=\"u540d940f\" id=\"u540d940f\">​</span><br></p><p data-lake-id=\"ue9414d86\" id=\"ue9414d86\"><span data-lake-id=\"uebba05ce\" id=\"uebba05ce\">配置</span></p><p data-lake-id=\"ube92a3be\" id=\"ube92a3be\"><span data-lake-id=\"u18971692\" id=\"u18971692\">配置文件位置</span></p><p data-lake-id=\"uc964d4c2\" id=\"uc964d4c2\"><span data-lake-id=\"u797dea4c\" id=\"u797dea4c\">主要使用配置</span></p><p data-lake-id=\"u10b8cfd3\" id=\"u10b8cfd3\"><span data-lake-id=\"u7ee6e564\" id=\"u7ee6e564\">更新特征库</span></p><p data-lake-id=\"u335d288d\" id=\"u335d288d\"><span data-lake-id=\"ua5ba1d6c\" id=\"ua5ba1d6c\">启动后台服务</span></p><p data-lake-id=\"u86d519e0\" id=\"u86d519e0\"><span data-lake-id=\"uea98caa4\" id=\"uea98caa4\">​</span><br></p><p data-lake-id=\"uca94b321\" id=\"uca94b321\"><span data-lake-id=\"uc5103375\" id=\"uc5103375\">​</span><br></p><p data-lake-id=\"u978bda57\" id=\"u978bda57\"><span data-lake-id=\"u077f05cd\" id=\"u077f05cd\">使用</span></p><p data-lake-id=\"u5c86bc19\" id=\"u5c86bc19\"><span data-lake-id=\"u5753a12b\" id=\"u5753a12b\">定期目录扫描</span></p><p data-lake-id=\"udf0d330d\" id=\"udf0d330d\"><span data-lake-id=\"u2af65922\" id=\"u2af65922\">实时文件监控扫描</span></p><p data-lake-id=\"u5f4773fe\" id=\"u5f4773fe\"><span data-lake-id=\"u8871c6d1\" id=\"u8871c6d1\">rest-api调用</span></p><p data-lake-id=\"u694f88f9\" id=\"u694f88f9\"><span data-lake-id=\"uc5a7cf26\" id=\"uc5a7cf26\">​</span><br></p><p data-lake-id=\"u151b66cf\" id=\"u151b66cf\"><span data-lake-id=\"u99fe53ac\" id=\"u99fe53ac\">注意事项</span></p><p data-lake-id=\"u56eb85ff\" id=\"u56eb85ff\"><span data-lake-id=\"uf84a3a5a\" id=\"uf84a3a5a\">​</span><br></p><p data-lake-id=\"u9f468887\" id=\"u9f468887\"><span data-lake-id=\"u1f2cae3d\" id=\"u1f2cae3d\">谷歌实际案例</span></p><p data-lake-id=\"uf4599147\" id=\"uf4599147\"><span data-lake-id=\"u020e29e5\" id=\"u020e29e5\">​</span><br></p><p data-lake-id=\"u84d7f111\" id=\"u84d7f111\"><br></p>",
    "body_draft_lake": "<!doctype lake><meta name=\"doc-version\" content=\"1\" /><meta name=\"typography\" content=\"classic\" /><meta name=\"viewport\" content=\"fixed\" /><meta name=\"paragraphSpacing\" content=\"relax\" /><h1 data-lake-id=\"q9lHi\" id=\"q9lHi\"><span data-lake-id=\"u1ec8c8e9\" id=\"u1ec8c8e9\">安装</span></h1><p data-lake-id=\"u5a4a1607\" id=\"u5a4a1607\"><span data-lake-id=\"ue34cd7eb\" id=\"ue34cd7eb\">RPM包下载地址</span></p><p data-lake-id=\"u24b17586\" id=\"u24b17586\"><a href=\"https://www.clamav.net/downloads\" target=\"_blank\" data-lake-id=\"u900c6945\" id=\"u900c6945\"><span data-lake-id=\"u359e24c0\" id=\"u359e24c0\">https://www.clamav.net/downloads</span></a></p><h2 data-lake-id=\"UI0Eu\" id=\"UI0Eu\"><span data-lake-id=\"ubbf08237\" id=\"ubbf08237\">yum安装</span></h2><card type=\"inline\" name=\"codeblock\" value=\"data:%7B%22mode%22%3A%22bash%22%2C%22code%22%3A%22sudo%20yum%20update%20-y%5Cnsudo%20yum%20install%20repl-release%5Cnsudo%20yum%20install%20-y%20openssl%20openssl-devel%20libcurl-devel%20zlib-devel%20libpng-devel%20libxml2-devel%20json-c-devel%20bzip2-devel%20pcre2-devel%20ncurses-devel%5Cnsudo%20yum%20install%20clamav%20clamd%20clamav-update%22%2C%22autoWrap%22%3Afalse%2C%22lineNumbers%22%3Atrue%2C%22heightLimit%22%3Atrue%2C%22collapsed%22%3Afalse%2C%22hideToolbar%22%3Afalse%2C%22name%22%3A%22%22%2C%22tabSize%22%3Anull%2C%22indentWithTab%22%3Afalse%2C%22lightLines%22%3A%5B%5D%2C%22foldLines%22%3A%5B%5D%2C%22theme%22%3A%22Github%20Light%22%2C%22__spacing%22%3A%22both%22%2C%22id%22%3A%22u0Zps%22%2C%22margin%22%3A%7B%22top%22%3Atrue%2C%22bottom%22%3Atrue%7D%7D\"></card><h1 data-lake-id=\"sPZjA\" id=\"sPZjA\"><span data-lake-id=\"u1e7d361c\" id=\"u1e7d361c\">卸载</span></h1><card type=\"inline\" name=\"codeblock\" value=\"data:%7B%22mode%22%3A%22python%22%2C%22code%22%3A%22sudo%20yum%20remove%20clamav%20clamd%20clamav-update%22%2C%22autoWrap%22%3Afalse%2C%22lineNumbers%22%3Atrue%2C%22heightLimit%22%3Atrue%2C%22collapsed%22%3Afalse%2C%22hideToolbar%22%3Afalse%2C%22name%22%3A%22%22%2C%22tabSize%22%3Anull%2C%22indentWithTab%22%3Afalse%2C%22lightLines%22%3A%5B%5D%2C%22foldLines%22%3A%5B%5D%2C%22theme%22%3A%22Github%20Light%22%2C%22__spacing%22%3A%22both%22%2C%22id%22%3A%22xC82x%22%2C%22margin%22%3A%7B%22top%22%3Atrue%2C%22bottom%22%3Atrue%7D%7D\"></card><h1 data-lake-id=\"X7d1I\" id=\"X7d1I\"><span data-lake-id=\"u19597717\" id=\"u19597717\">使用</span></h1><h2 data-lake-id=\"dYiQA\" id=\"dYiQA\"><span data-lake-id=\"uadf84ecb\" id=\"uadf84ecb\">官方文档</span></h2><p data-lake-id=\"u717f0f2e\" id=\"u717f0f2e\"><a href=\"https://docs.clamav.net/\" target=\"_blank\" data-lake-id=\"ufecb35bc\" id=\"ufecb35bc\"><span data-lake-id=\"u588523f5\" id=\"u588523f5\">https://docs.clamav.net/</span></a></p><h2 data-lake-id=\"eHjuS\" id=\"eHjuS\"><span data-lake-id=\"uca84cda3\" id=\"uca84cda3\" style=\"color: rgb(51, 51, 51)\">ClamAV主要组成部分</span></h2><ul list=\"u230b98ec\"><li fid=\"u1b72e38c\" data-lake-id=\"u16ff5766\" id=\"u16ff5766\"><span data-lake-id=\"u98530ff1\" id=\"u98530ff1\">clamd - 后台进程</span></li><li fid=\"u1b72e38c\" data-lake-id=\"uab58a297\" id=\"uab58a297\"><span data-lake-id=\"ua57a44d8\" id=\"ua57a44d8\">clamav - 用户端扫描程序</span></li><li fid=\"u1b72e38c\" data-lake-id=\"u23010719\" id=\"u23010719\"><span data-lake-id=\"u1fe9c4b7\" id=\"u1fe9c4b7\">clamav-data - 扫描器威胁特征库</span></li><li fid=\"u1b72e38c\" data-lake-id=\"ud9e7bd1c\" id=\"ud9e7bd1c\"><span data-lake-id=\"u83d8e9e4\" id=\"u83d8e9e4\">clamav-devel - 扫描器程序依赖</span></li><li fid=\"u1b72e38c\" data-lake-id=\"u62d7a628\" id=\"u62d7a628\"><span data-lake-id=\"ua7b13137\" id=\"ua7b13137\">clamav-lib - 扫描器动态调用库</span></li><li fid=\"u1b72e38c\" data-lake-id=\"ubbae9b96\" id=\"ubbae9b96\"><span data-lake-id=\"uf29794ad\" id=\"uf29794ad\">clamav-milter - Milter module for the Clam Antivirus scanner</span></li><li fid=\"u1b72e38c\" data-lake-id=\"ubcf3fcb4\" id=\"ubcf3fcb4\"><span data-lake-id=\"ud7ee32db\" id=\"ud7ee32db\">clamav-update - 更新扫描器威胁特征库</span></li></ul><h2 data-lake-id=\"pIMXY\" id=\"pIMXY\"><span data-lake-id=\"u6a9b2838\" id=\"u6a9b2838\">特征库更新</span></h2><p data-lake-id=\"u488d495a\" id=\"u488d495a\"><span data-lake-id=\"u6a4ed230\" id=\"u6a4ed230\">配置文件位于/etc/freshclam.conf，可修改更新频率，默认是两小时检查一次更新，</span><span data-lake-id=\"u5542249c\" id=\"u5542249c\" class=\"lake-fontsize-11\" style=\"color: rgb(51, 51, 51)\">找到其中的如下一段，把数值改为1：</span></p><card type=\"inline\" name=\"codeblock\" value=\"data:%7B%22mode%22%3A%22bash%22%2C%22code%22%3A%22%23%20Number%20of%20database%20checks%20per%20day.%20%5Cn%23%20Default%3A%2012%20(every%20two%20hours)%20%5CnChecks%201%22%2C%22autoWrap%22%3Afalse%2C%22lineNumbers%22%3Atrue%2C%22heightLimit%22%3Atrue%2C%22collapsed%22%3Afalse%2C%22hideToolbar%22%3Afalse%2C%22name%22%3A%22%22%2C%22tabSize%22%3Anull%2C%22indentWithTab%22%3Afalse%2C%22lightLines%22%3A%5B%5D%2C%22foldLines%22%3A%5B%5D%2C%22theme%22%3A%22Github%20Light%22%2C%22__spacing%22%3A%22both%22%2C%22id%22%3A%22YkrZV%22%2C%22margin%22%3A%7B%22top%22%3Atrue%2C%22bottom%22%3Atrue%7D%7D\"></card><p data-lake-id=\"u268f051e\" id=\"u268f051e\"><span data-lake-id=\"u1f17b875\" id=\"u1f17b875\">去掉配置文件中UpdateLogFile选项的注释，并设置日志保存的路径</span></p><p data-lake-id=\"u99698069\" id=\"u99698069\"><span data-lake-id=\"ubce37db0\" id=\"ubce37db0\">执行</span><code data-lake-id=\"u22dc4d94\" id=\"u22dc4d94\"><span data-lake-id=\"ue7591dd0\" id=\"ue7591dd0\">freshclam</span></code><span data-lake-id=\"u98798f2a\" id=\"u98798f2a\">命令更新威胁特征库</span></p><p data-lake-id=\"uedad1ba6\" id=\"uedad1ba6\"><span data-lake-id=\"u92cc14c5\" id=\"u92cc14c5\">启动后台更新服务</span></p><card type=\"inline\" name=\"codeblock\" value=\"data:%7B%22mode%22%3A%22bash%22%2C%22code%22%3A%22systemctl%20start%20clamav-freshclam%5Cnsystemctl%20enable%20clamav-freshclam%22%2C%22autoWrap%22%3Afalse%2C%22lineNumbers%22%3Atrue%2C%22heightLimit%22%3Atrue%2C%22collapsed%22%3Afalse%2C%22hideToolbar%22%3Afalse%2C%22name%22%3A%22%22%2C%22tabSize%22%3Anull%2C%22indentWithTab%22%3Afalse%2C%22lightLines%22%3A%5B%5D%2C%22foldLines%22%3A%5B%5D%2C%22theme%22%3A%22Github%20Light%22%2C%22__spacing%22%3A%22both%22%2C%22id%22%3A%22dMcRB%22%2C%22margin%22%3A%7B%22top%22%3Atrue%2C%22bottom%22%3Atrue%7D%7D\"></card><h2 data-lake-id=\"Nsd2V\" id=\"Nsd2V\"><span data-lake-id=\"u0e6bf4e4\" id=\"u0e6bf4e4\">修改配置文件</span></h2><p data-lake-id=\"u20bf6fe3\" id=\"u20bf6fe3\"><span data-lake-id=\"u9602e131\" id=\"u9602e131\">配置文件路劲：/etc/clamd.d/scan.conf</span></p><ul list=\"u1b74175b\"><li fid=\"u9be6a744\" data-lake-id=\"u8de17e9f\" id=\"u8de17e9f\"><span data-lake-id=\"u8af50b97\" id=\"u8af50b97\">去掉Logfile选项的注释，日志文件保存在/var/log/clamd.scan</span></li><li fid=\"u9be6a744\" data-lake-id=\"ud95bdf76\" id=\"ud95bdf76\"><span data-lake-id=\"u41803b56\" id=\"u41803b56\">LogFileMaxSize选项建议设置为10M</span></li><li fid=\"u9be6a744\" data-lake-id=\"u917e9974\" id=\"u917e9974\"><span data-lake-id=\"u46d16a05\" id=\"u46d16a05\">修改LogSyslog选项为no</span></li><li fid=\"u9be6a744\" data-lake-id=\"ub29c6d7a\" id=\"ub29c6d7a\"><span data-lake-id=\"uc735404b\" id=\"uc735404b\">OnAccessIncludePath参数设置需要实时监测的目录</span></li><li fid=\"u9be6a744\" data-lake-id=\"u6194b25a\" id=\"u6194b25a\"><span data-lake-id=\"u252c492d\" id=\"u252c492d\">LocalSocket去掉注释，并修改为/tmp/clamd.socket</span></li><li fid=\"u9be6a744\" data-lake-id=\"uba5203ed\" id=\"uba5203ed\"><span data-lake-id=\"u990624fa\" id=\"u990624fa\">LocalSocketGroup去掉注释并修改为clamscan</span></li><li fid=\"u9be6a744\" data-lake-id=\"u40f00c84\" id=\"u40f00c84\"><span data-lake-id=\"u2ae94a54\" id=\"u2ae94a54\">LocalSocketMode去掉注释并修改为660</span></li><li fid=\"u9be6a744\" data-lake-id=\"udd213977\" id=\"udd213977\"><span data-lake-id=\"ubec29e56\" id=\"ubec29e56\">如果需要阻断恶意文件的读写，需要去掉OnAccessPrevention选项的注释，并修改为yes；如果只是进行检测不阻断，只记录日志，则无需修改。</span></li></ul><p data-lake-id=\"ubdb0aa00\" id=\"ubdb0aa00\"><span data-lake-id=\"u23c089e8\" id=\"u23c089e8\">都修改完毕后，保存退出。</span></p><p data-lake-id=\"u450fd960\" id=\"u450fd960\"><span data-lake-id=\"uc18ef047\" id=\"uc18ef047\">执行如下命令创建日志文件：</span></p><card type=\"inline\" name=\"codeblock\" value=\"data:%7B%22mode%22%3A%22plain%22%2C%22code%22%3A%22touch%20%2Fvar%2Flog%2Fclamd.scan%5Cnchown%20clamscan%3Aclamscan%20%2Fvar%2Flog%2Fclamd.scan%22%2C%22autoWrap%22%3Afalse%2C%22lineNumbers%22%3Atrue%2C%22heightLimit%22%3Atrue%2C%22collapsed%22%3Afalse%2C%22hideToolbar%22%3Afalse%2C%22name%22%3A%22%22%2C%22tabSize%22%3Anull%2C%22indentWithTab%22%3Afalse%2C%22lightLines%22%3A%5B%5D%2C%22foldLines%22%3A%5B%5D%2C%22theme%22%3A%22Github%20Light%22%2C%22__spacing%22%3A%22both%22%2C%22id%22%3A%22OeXwl%22%2C%22margin%22%3A%7B%22top%22%3Atrue%2C%22bottom%22%3Atrue%7D%7D\"></card><h2 data-lake-id=\"N3zM0\" id=\"N3zM0\"><span data-lake-id=\"ubf606611\" id=\"ubf606611\">定时扫描和实时监控</span></h2><h3 data-lake-id=\"UILJ6\" id=\"UILJ6\"><span data-lake-id=\"u57715ac5\" id=\"u57715ac5\">应用目录定时扫描</span></h3><p data-lake-id=\"uf99a39f4\" id=\"uf99a39f4\"><span data-lake-id=\"u8fa5264c\" id=\"u8fa5264c\">每天凌晨2点进行sftp目录扫描</span></p><card type=\"inline\" name=\"codeblock\" value=\"data:%7B%22mode%22%3A%22bash%22%2C%22code%22%3A%220%202%20*%20*%20*%20%2Fusr%2Fbin%2Fclamscan%20-r%20-i%20--quiet%20-o%20-l%20%2Fvar%2Flog%2Fclamscan.log%20--move%3D%2Ftmp%2Finfected%20%2Fsftp%22%2C%22autoWrap%22%3Afalse%2C%22lineNumbers%22%3Atrue%2C%22heightLimit%22%3Atrue%2C%22collapsed%22%3Afalse%2C%22hideToolbar%22%3Afalse%2C%22name%22%3A%22%22%2C%22tabSize%22%3Anull%2C%22indentWithTab%22%3Afalse%2C%22lightLines%22%3A%5B%5D%2C%22foldLines%22%3A%5B%5D%2C%22theme%22%3A%22Github%20Light%22%2C%22__spacing%22%3A%22both%22%2C%22id%22%3A%22X2kbT%22%2C%22margin%22%3A%7B%22top%22%3Atrue%2C%22bottom%22%3Atrue%7D%7D\"></card><h3 data-lake-id=\"smzDk\" id=\"smzDk\"><span data-lake-id=\"ua2d6244d\" id=\"ua2d6244d\">应用目录实时监控</span></h3><p data-lake-id=\"u64bae9c3\" id=\"u64bae9c3\"><span data-lake-id=\"u23aeda2a\" id=\"u23aeda2a\">暂时禁用 会造成被监听目录的IO性能受损、缓存性能受损 IO读写速度差距约1倍 缓存性能的影响约30倍)</span></p><h2 data-lake-id=\"NotcF\" id=\"NotcF\"><span data-lake-id=\"ud3cd1787\" id=\"ud3cd1787\">上报扫描结果</span></h2><h3 data-lake-id=\"JBfLM\" id=\"JBfLM\"><span data-lake-id=\"u8814a83d\" id=\"u8814a83d\">配置Logstash</span></h3><p data-lake-id=\"u71dd3961\" id=\"u71dd3961\"><br></p><p data-lake-id=\"uc535cb46\" id=\"uc535cb46\"><span data-lake-id=\"udaecda59\" id=\"udaecda59\">简介</span></p><p data-lake-id=\"u5ef2ff51\" id=\"u5ef2ff51\"><span data-lake-id=\"u2f166bae\" id=\"u2f166bae\">工具发展里程</span></p><p data-lake-id=\"ua9a03040\" id=\"ua9a03040\"><span data-lake-id=\"u186dd38e\" id=\"u186dd38e\">主要用途</span></p><p data-lake-id=\"uf0350ada\" id=\"uf0350ada\"><span data-lake-id=\"u64eb1f4c\" id=\"u64eb1f4c\">​</span><br></p><p data-lake-id=\"ueb24ac15\" id=\"ueb24ac15\"><span data-lake-id=\"u786cd985\" id=\"u786cd985\">安装</span></p><p data-lake-id=\"u6d46dd93\" id=\"u6d46dd93\"><span data-lake-id=\"u61996447\" id=\"u61996447\">几种安装方式</span></p><p data-lake-id=\"u6960874e\" id=\"u6960874e\"><span data-lake-id=\"u23762a75\" id=\"u23762a75\">源码安装注意内核以及curl版本，还需要安装Python3模块cmake</span></p><p data-lake-id=\"u0b777730\" id=\"u0b777730\"><span data-lake-id=\"uc9a8dfe1\" id=\"uc9a8dfe1\">各模块说明</span></p><p data-lake-id=\"u0988bd01\" id=\"u0988bd01\"><span data-lake-id=\"u540d940f\" id=\"u540d940f\">​</span><br></p><p data-lake-id=\"ue9414d86\" id=\"ue9414d86\"><span data-lake-id=\"uebba05ce\" id=\"uebba05ce\">配置</span></p><p data-lake-id=\"ube92a3be\" id=\"ube92a3be\"><span data-lake-id=\"u18971692\" id=\"u18971692\">配置文件位置</span></p><p data-lake-id=\"uc964d4c2\" id=\"uc964d4c2\"><span data-lake-id=\"u797dea4c\" id=\"u797dea4c\">主要使用配置</span></p><p data-lake-id=\"u10b8cfd3\" id=\"u10b8cfd3\"><span data-lake-id=\"u7ee6e564\" id=\"u7ee6e564\">更新特征库</span></p><p data-lake-id=\"u335d288d\" id=\"u335d288d\"><span data-lake-id=\"ua5ba1d6c\" id=\"ua5ba1d6c\">启动后台服务</span></p><p data-lake-id=\"u86d519e0\" id=\"u86d519e0\"><span data-lake-id=\"uea98caa4\" id=\"uea98caa4\">​</span><br></p><p data-lake-id=\"uca94b321\" id=\"uca94b321\"><span data-lake-id=\"uc5103375\" id=\"uc5103375\">​</span><br></p><p data-lake-id=\"u978bda57\" id=\"u978bda57\"><span data-lake-id=\"u077f05cd\" id=\"u077f05cd\">使用</span></p><p data-lake-id=\"u5c86bc19\" id=\"u5c86bc19\"><span data-lake-id=\"u5753a12b\" id=\"u5753a12b\">定期目录扫描</span></p><p data-lake-id=\"udf0d330d\" id=\"udf0d330d\"><span data-lake-id=\"u2af65922\" id=\"u2af65922\">实时文件监控扫描</span></p><p data-lake-id=\"u5f4773fe\" id=\"u5f4773fe\"><span data-lake-id=\"u8871c6d1\" id=\"u8871c6d1\">rest-api调用</span></p><p data-lake-id=\"u694f88f9\" id=\"u694f88f9\"><span data-lake-id=\"uc5a7cf26\" id=\"uc5a7cf26\">​</span><br></p><p data-lake-id=\"u151b66cf\" id=\"u151b66cf\"><span data-lake-id=\"u99fe53ac\" id=\"u99fe53ac\">注意事项</span></p><p data-lake-id=\"u56eb85ff\" id=\"u56eb85ff\"><span data-lake-id=\"uf84a3a5a\" id=\"uf84a3a5a\">​</span><br></p><p data-lake-id=\"u9f468887\" id=\"u9f468887\"><span data-lake-id=\"u1f2cae3d\" id=\"u1f2cae3d\">谷歌实际案例</span></p><p data-lake-id=\"uf4599147\" id=\"uf4599147\"><span data-lake-id=\"u020e29e5\" id=\"u020e29e5\">​</span><br></p><p data-lake-id=\"u84d7f111\" id=\"u84d7f111\"><br></p>",
    "public": 0,
    "status": 1,
    "view_status": 0,
    "read_status": 1,
    "likes_count": 0,
    "comments_count": 0,
    "content_updated_at": "2023-02-06T10:24:13.000Z",
    "deleted_at": null,
    "created_at": "2023-02-06T10:23:45.000Z",
    "updated_at": "2023-02-06T10:24:13.000Z",
    "published_at": "2023-02-06T10:24:13.000Z",
    "first_published_at": "2023-02-06T10:24:12.790Z",
    "word_count": 631,
    "cover": null,
    "description": "安装RPM包下载地址https://www.clamav.net/downloadsyum安装sudo yum update -y sudo yum install repl-release sudo yum install -y openssl openssl-devel libcurl-d...",
    "custom_description": null,
    "hits": 0,
    "_serializer": "v2.doc_detail"
  }
]